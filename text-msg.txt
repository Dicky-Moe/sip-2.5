Text message format for SIP 2.5 discussion
==========================================

Contexts: 4xx and 6xx response content, MESSAGE request content, MESSAGE response content (if any), MSRP content.
This does not apply for streaming text.

Use "text/plain; charset=utf-8" as common denominator, supported by all implementations. Other encodings ("charset") and formats may be negotiated. Encoding need not be IRA (ASCII) compatible.

Teletype control: Use HT, CR LF pair (but switch to Unicode separators if you can), VT. If 7-bit charset is negotiated (e.g. KOI-7), use SO/SI pair.
It won't make sense to use FF, as messages are normally displayed, not printed.
Do not use start-of-header, start-of-text, end-of-text, end-of-transmission, as they do not make sense, not because thay conflict with SIP 2.5.
Do not use BS (it make sense only in streaming text) or other codes.

Computer control: It's only valid code is ESC (as specified in ISO 2022). However, it is context-specific, at least keyboard input vs mouse input (X10 is incompatible with ISO 2022 and UTF-8, although used by T.128) vs display output vs printer control language (PCL) and printer job language (PJL). Unless its usage can be negotiated, do not use it either.

C1 control: in UTF-8, they formally appear as 0xC2 0xNN. However, for simplicity, 0xC2 may be omitted.

Emoji. To keep the purpose of defining "on-the-wire" and declaring some codepoint combinations as invalid and do-not-emit:
- {not Emoji} {VS15 or VS16} => INVALID [ignore VS when rendering].
Note: some implementations show few pictograms and symbols as emoji though they do not have the Emoji property. See below.
- {EPres} {VS16} => INVALID. The author in unaware of any implementation which makes sense from VS-16.
- {Emoji} {VS15} => text-presentation. Never treat that as emoji, however. E.g. no tag, no ZWJ at either side.
- {not EBase} {EMod} => INVALID [split]
- {Emoji not EPres} {not VS16 nor EMod} => text-presentation
- {EPres} {not VS15} => tag_base
- {EBase} {EMod} => tag_base
- {Emoji not EPres} {VS16} => tag_base
- {tag_base} {no tag i.e. U+E0020...U+E007F} => "untagged" emoji_ZWJ_element
Country flags and keycaps are formally also emoji-ZWJ-elements.
- {tag_base} {tag_name} {tag_value} {tag_end U+E007F} => emoji_ZWJ_element
Where tag_name is 0 or more U+E0041...U+E005A characters. The only approved (as per 17.0) name is null, but there are few proposed.
Where tag_value is 1 or more U+E0030...U+E0039, U+E0061...U+E007A characters. They are interpreted specifically to tag_name, or if it is null, tag_base.
Any other use of tag characters is INVALID. [Ignore them.]

Tags (U+E0020...U+E007F) are only useful with emoji; earlier usage as language tags is no longer part of Unicode. By earlier drafts, the sequence is base emoji (possibly with VS or modifier, but currently none), tag name of 0 or more (U+E0041...U+E005A) (currently, empty, but there are propositions), tag value of one or more (U+E0061...U+E007A or U+E0030...U+E0039), end U+E007F. The "tag name" part determines the nature of the tag, more than emoji itself (which is fallback). There were 3 propositions, none of them approved. Currently, only empty name approved for sub-country flags. There is also suggestion for families. The tag value is interpreted according to the tag name.

Emoticons (such as :-) or (_Y_) ) should appear as such, no conversion to emoji (even standard). If the author wishes, convert them at input. This does not appply if the charset is restricted.

Emotons. This is name for :smiling_cat: etc. sequences.
TODO: give some formal definition, reference General_Category (might be written in other languages, say, Russian).
Emotons are implementation-specific. TODO: define precondition: if the target encoding supports emoji, then translate the emoton into an emoji. In that case, the emoton is INVALID. The target emoji can be an implementation-specific ZWJ sequence. However, an emoton is valid if it cannot be translated.

Use negotiated private codes (possibly as emoji) as implementation-specific.

Do not use non-characters and sentinels.

text/html
=========

Use this when markup is needed, e.g. bold text, pictures (not emoji) etc. There are more restrictions for characters in use (no subscript, superscript, line separator, paragraph separator, some control codes etc.) Use elements instead. Also, the message must be self-contained, with styles and pictures inline.

Unicode defines language tags to enforce emoji presentation. E.g. <span lang="und-u-em-emoji">&#...;</span>. This has lower priority than VS, but higher than EPres. However, this document defines interaction between properties and VS with potentially undesired effects. (For instance, the language tag is und-u-em-text, the codepoint has EPres, followed by VS16. According to the above, VS16 is invalid and is ignored, so the resulting presentation is text.) Also, this can display non-Emoji characters (symbols and pictograms) or grapheme clusters (e.g. involving U+20E3) as emoji; there are few implementations that display some non-Emoji characters as emoji. In addition, implementations may use fonts to select different images for the same character. For instance, FEMALE SIGN (actually refers to Venus) may appear as an astronomical sign (common), view of the planet (if there is a font named "Planets"), or erotic picture of the goddess (if there is a font named "Erotica").

image/png, image/jpeg
=====================

Use if the message is just a picture, no text (or it is pre-rendered). Other formats may be negotiated.

audio/?
=======
For voice messages